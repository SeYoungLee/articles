# Generative Adversarial Nets


이 포스팅은 Unsupervised learning 중 generative adversarial network(GAN)에 대해서 설명하는 포스트입니다.

겐 또는 간이라고 불리며, 2014년 Ian Goodfellow가 처음 제안한 방법론으로 최근 기하급수적으로 연구되고 있는 모델이다.
![gan_zoo](/gan_zoo.png)


GAN에 대해서 말하기전에 먼저 머신러닝관점에서 GAN과 같은 generative model이 어떤 식으로 데이터를 학습하는 것인지 이야기해보자

### 머신러닝 모델은 학습방식에 따라 크게 지도학습(supervised learning)과 비지도학습(unsupervised learning)으로 나뉜다. 
(최근 활발히 연구되는 강화학습은 따로 분류하겠다)

![ML](/ML.png)

지도학습은 분석자가 데이터를 분석하여 어떤 상태에서는 어떤 결과가 나온다는 것을 기계에게 일일히 지도하여 학습하는 방법이다. 학습 후 기계에게 특정 상황에서 어떤 결과가 나올지 물어보면, 기계는 학습한 경험을 바탕으로 나름대로 추론한 결과를 제시한다. 예를 들어 개와 고양이 사진을 주고 A는 개사진이고, B는 고양이사진이라고 결과값을 지정하여 기계에게 학습시키면, 다음에 어떤 사진 C가 개인지 고양이인지 분류하는 작업을 수행할수 있다.

![disriminator](/discriminator.png)

반면 비지도학습은 기계에게 데이터만 주어주고, 기계가 알아서 데이터의 숨겨진 구조와 패턴을 파악하도록 하는 것이다. 아무 결과값도 주어지지 않기때문에 기계가 자율적으로 파악하는 학습법이다. 

![gen](/gen.png)

### 특히 비지도학습 중에서 generative model은 주어진 데이터의 분포를 학습하여 학습한 데이터와 비슷하게 새로운 데이터를 생성하는 모델이다. 
이때 입력값은 잠재공간속의 임의의 값이다. 누구간에게 고양이 그림을 그리도록 시킨다고 해보자. 어제 그린 고양이 그림과 오늘 그린 고양이 그림이 같을까? 아마도 다를것이다. 그림을 그릴때의 기분이나 그림을 그릴때 쓴 도구들이 달라질수 있기 때문이다. 이처럼 어떤 데이터를 생성할때는 외부요인에 의한 random요소가 포함되는데, 이를 latent vector로 생각할수 있다. 추후 이야기하겠지만, latent vector를 잘 manipulate할수 있다면 우리는 원하는 형태의 데이터를 얻을 수 있을것이다. 


### 그렇다면 데이터의 분포를 학습한다는 것은 무슨 의미일까?
동전 던지기를 생각해보자. 누군가에게 100번 동전을 던지 결과를 보여주고 다음번에 동전을 던지면 어떤 결과가 나올지 대답해보라고 한다. 아마도 그 사람은 앞이 나올 확률과 뒤가 나올 확를 계산하여 확률이 더 큰 쪽으로 대답할 것이다. 데이터의 분포를 학습한다는 것도 앞이 나올 확률, 뒤가 나올 확률, 즉 모든 경우에 수에 대해서 확률값을 계산한다는 의미이다. 

![prob_dist](/prob_dist.png)


개와 고양이 이미지를 섞어 genertive model을 학습시킬 경우도 마찬가지이다. 아래 그림은 1차원 확률분포로 그렸지만 실제로는 고차원 공간에서 확률분포를 상상하자. 만약 학습데이터에 개 사진이 많았다면 개사진 근처의 확률값이 높을 것이고, 고걍이 사진이 많았다면 고양이 사진 근처의 확률값이 높을 것이다.

![prob_dog](/prob_dog.png)


### 그렇다면 대체 데이터의 분포를 학습하면 뭐가 좋다는 걸까? 
개 사진을 보고 개라고 분류하는 것과 도화지에 개를 그리는 것 중 어느 것이 더 쉬울까?
개와 고양이 사진을 분류하는 모델과 개 그림을 그릴줄 아는 모델 중 어느것이 더 똑똑하다고 할수 있을까?
아마도 대부분의 사람들은 분류모델보다는 그림을 그릴수 있는 모델이 개와 고양이에 대해서 더 잘 이해하고 있다고 생각할 것이다. 
데이터를 잘 이해하고 있다면, 분류하는 문제는 매우 쉬울 수 있다. 


### genertive model의 종류

GAN은 Alexnet, ResNet처럼 특정한 네트워크의 구조를 말하는게 아니라, 입력데이터와 유사한 이미지를 생성하는 모델(Gentor라고 하자)을 학습시키는 방법을 제안한 방법론(framework)이다. 

Goodfellow는 게임이론을 이용하여 generator생성하는 문제를 일종의 최적화 문제로 봤다. 예를들어


